イベントフックとは、イベントが発生したときに指定したフォルダ内に存在するファイルを順番に実行する機能です。  
イベント内容の詳細は実行される際の環境変数に設定されます。

比較的高度な機能のため、これらの単語が理解できない方の利用はおすすめしません。

また、プレリリースの間はこれらの値はアップデートにより予告なく変化することがあります。ご了承下さい。  
現状機能は少ないですが、今後のアップデートで継続的に追加する予定です。

これらの機能は現状タイムシフト中でも動作します。十分注意してください。

## 環境変数の仕様(共通)

|環境変数名|解説|取りうる値|
|---|---|---|
|`KEVI_EVENT_TYPE`|イベントの種類|後述するイベントの種類に記載|

## 実行仕様

指定されたフォルダ内に存在するファイルを実行します。  
連続してイベントが発生した場合、並列して実行される可能性があります。

### Windows

フォルダ内のすべてのファイルをシェルから実行します。(cmd /c start 経由)  
ドキュメントファイルなどを設置した場合そのファイルが既定のアプリケーションで開かれます。

### Linux/macOS

実行可能と判断されたファイルを実行します。起動時のウィンドウ表示を抑制しています。  
現時点で未テストのため動作の保証はしません。  
実行に時間がかかるアプリが多くなった場合、動作が不安定になる可能性があります。ご了承下さい。

## イベント仕様

### 揺れの検知(0.12.8機能追加)

KEVI_EVENT_TYPE: `KMONI_SHAKE_DETECTED`

|環境変数名|解説|例|
|---|---|---|
|`SHAKE_DETECT_ID`|検知ID|`F95F8C13-7DA0-438E-9F02-BB5665B0577A`(UUID)|
|`SHAKE_DETECT_LEVEL`|検知した揺れの強さ|`Weaker`(計測震度-1.5以上) `Weak`(震度1未満) `Medium`(震度2以下) `Strong`(震度3以上) `Stronger`(震度5弱以上)|
|`SHAKE_DETECT_MAX_INTENSITY`|検知した揺れの最大震度|`-1.0`|
|`SHAKE_DETECT_REGIONS`|(0.12.8追加)カンマ区切りの揺れを検知した地域|`大阪府,神奈川,北海道`|

- 強さが変化したときにも発生します。震度が上昇しただけではイベントが発生しません。
- Weaker については内部追跡値であり、誤検知が多いため利用はおすすめしません。

### 緊急地震速報の受信(0.12.0実装)

KEVI_EVENT_TYPE: `EEW_RECEIVED`

|環境変数名|解説|例|
|---|---|---|
|`EEW_SOURCE`|受信元|`DM-D.S.S(気象庁本庁)`/`強震モニタ`|
|`EEW_EVENT_ID`|EEWのID|`20220723035202`|
|`EEW_COUNT`|報数|`1`|
|`EEW_PLACE`|震央地名|`鳥取県沖`/`不明(未受信)`|
|`EEW_INTENSITY`|最大震度|`0` `1`..`5-` `5+`..`7`|
|`EEW_IS_FINAL`|最終報か|`True`/`False`|
|`EEW_IS_CANCEL`|キャンセル報か|`True`/`False`|

- 受信したとき･別のソースのEEWに更新されたときに発生します。
